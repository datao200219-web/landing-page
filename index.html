<script>
    const form = document.getElementById("form");
    form.addEventListener("submit", function(event) {
        event.preventDefault(); // Prevent the default form submission

        const age = document.getElementById("age").value; // Get the age
        const phone = document.getElementById("phone").value; // Get the phone number
        const email = document.getElementById("email").value; // Get the email
        const agreeCheckbox = document.getElementById("agree"); // Get the agree checkbox

        // Ensure user agrees to the privacy policy before submitting
        if (!agreeCheckbox.checked) {
            alert("You must agree to the privacy policy to submit the form.");
            return; // If not agreed, prevent form submission
        }

        // Prepare the data to send to the backend
        const data = { phone, email, age };

        // Send data to backend server (assuming backend is running on localhost:3000)
        fetch("http://localhost:3000/submit", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify(data)
        })
        .then(response => response.json())
        .then(data => {
            if (data.customerLink) {
                window.location.href = data.customerLink;  // Redirect to customer service link
            } else {
                alert("There was an issue processing your request. Please try again.");
            }
        })
        .catch((error) => {
            alert("There was an error submitting the form!");
            console.error("Error:", error);
        });
    });
</script>
